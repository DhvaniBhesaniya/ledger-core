dhvani@inventyv:~/personal_work/ledger-core$ docker compose up -d
[+] Running 2/2
 ✔ Container transaction_service_db       Healthy                                                                                                                                                            12.2s 
 ✔ Container transaction_service_adminer  Started                                                                                                                                                            12.4s 
dhvani@inventyv:~/personal_work/ledger-core$ docker ps -a
CONTAINER ID   IMAGE                COMMAND                  CREATED          STATUS                    PORTS                                         NAMES
c42d0629ab21   adminer:latest       "entrypoint.sh docke…"   20 seconds ago   Up 7 seconds              0.0.0.0:8081->8080/tcp, [::]:8081->8080/tcp   transaction_service_adminer
0ee81db401cf   postgres:15-alpine   "docker-entrypoint.s…"   20 seconds ago   Up 18 seconds (healthy)   0.0.0.0:5432->5432/tcp, [::]:5432->5432/tcp   transaction_service_db
dhvani@inventyv:~/personal_work/ledger-core$ docker compose down
[+] Running 3/3
 ✔ Container transaction_service_adminer    Removed                                                                                                                                                           0.2s 
 ✔ Container transaction_service_db         Removed                                                                                                                                                           0.2s 
 ✔ Network ledger-core_transaction_network  Removed                                                                                                                                                           0.2s 
dhvani@inventyv:~/personal_work/ledger-core$








sudo apt-get update
sudo apt-get install libpq-dev

# Uninstall current diesel_cli
cargo uninstall diesel_cli

# Install diesel_cli with postgres feature only
cargo install diesel_cli --no-default-features --features postgres




1. Create migration
   diesel migration generate create_accounts
   
2. Write SQL in up.sql
   CREATE TABLE accounts (...)
   
3. Run migration
   diesel migration run
   
4. Auto-generate Rust schema
   diesel print-schema > src/schema.rs
   
5. Define models in models.rs
   #[derive(Queryable, Selectable)]
   pub struct Account { ... }
   
6. Write repository functions
   pub fn get_account(id: i64, conn: &mut PgConnection) -> ...
   
7. Use in handlers
   let account = account_repo::get_account(123, &conn)?;




   Step 1: Install Prerequisites
bash
# Install Rust (if not already)
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
source $HOME/.cargo/env

# Install Diesel CLI
cargo install diesel_cli --no-default-features --features postgres


Step 4: Set Up Database
bash
# Start Docker
docker-compose up -d

# Wait for PostgreSQL to be ready
sleep 10

# Create .env from example
cp .env.example .env

# Initialize Diesel
diesel setup

# Create migrations
diesel migration generate create_accounts
diesel migration generate create_api_keys
diesel migration generate create_transactions
diesel migration generate create_webhook_endpoints
diesel migration generate create_webhook_events

# Copy migration SQL from guide into migration files
# Then run migrations
diesel migration run

# Generate schema
diesel print-schema > src/schema.rs

# Reset database (drop and create (this will drop all data))
# diesel database reset






dhvani@inventyv:~/personal_work/ledger-core$ uuidgen
ed6477c2-d79f-44f6-986b-42377d6c0be3

admin_uuid = ed6477c2-d79f-44f6-986b-42377d6c0be3
sk_prod_ed6477c2-d79f-44f6-986b-42377d6c0be3
dhvani@inventyv:~/personal_work/ledger-core$ echo -n "sk_prod_ed6477c2-d79f-44f6-986b-42377d6c0be3" | sha256sum
4d9c8a9fb98de379a361ddd5e9765266b4d88ed8e5d76c40887b6b6fd71fa5df  -


INSERT INTO api_keys (
    account_id, key_hash, key_prefix, name,
    is_active, rate_limit_per_minute, role,
    created_at, updated_at
) VALUES (
    NULL,  -- Admin keys don't need an account!
    '4d9c8a9fb98de379a361ddd5e9765266b4d88ed8e5d76c40887b6b6fd71fa5df',
    'sk_prod_4d9c8a9fb98d',
    'Bootstrap Admin Key',
    true, 1000, 'admin',
    NOW(), NOW()
);





# 1. Start services
docker-compose up -d

# 2. Verify PostgreSQL is running
docker-compose ps
# Should show: postgres - Up (healthy)
#              adminer - Up
#              app - Up

# 3. Check database is accessible
docker-compose exec postgres psql -U postgres -d transaction_service -c "\dt"
# Should list: accounts, api_keys, transactions, webhook_endpoints, webhook_events

# 4. Check app is running
curl http://localhost:8080/health
# Should respond: OK





Access Adminer web UI
# Open: http://localhost:8081
# Server: postgres
# Username: postgres
# Password: password
# Database: transaction_service

# Or use psql command line
docker-compose exec postgres psql -U postgres -d transaction_service

# Inside psql:
SELECT * FROM accounts;
SELECT * FROM api_keys;
SELECT version();
Phase 3: Create Test Account
# First, we need an API key
# For testing, let's create one manually in database

docker-compose exec postgres psql -U postgres -d transaction_service










{
    "account": {
        "id": 1,
        "business_name": "My Business",
        "balance": 0,
        "currency": "USD",
        "is_active": true
    },
    "secret_api_key": "sk_prod_69ff2af3-9c94-4a55-ac87-a568f3146a9c"
}

{
    "account": {
        "id": 2,
        "business_name": "My Business 2",
        "balance": 0,
        "currency": "USD",
        "is_active": true
    },
    "secret_api_key": "sk_prod_dc06bdeb-b1a0-4f33-906e-b164b08b9219"
}